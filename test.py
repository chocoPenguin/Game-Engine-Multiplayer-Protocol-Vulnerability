from scapy.all import *
import ue4lib

outermsg = ue4lib.MessageWriter(padded = True)

outermsg.write_bit(0)

msg = ue4lib.MessageWriter(padded = True)

for _ in range(0, 4):
    msg.write_bit(0)

seq_str = struct.pack("<H", 16423)
acked_seq_str = struct.pack("<H", 3791 & 0xFFFF)

msg.write_buffer(acked_seq_str, 14)
msg.write_buffer(seq_str, 14)

output = msg.output()

outermsg.write_buffer(output, len(output) * 8)

#self.send(outermsg.output())

reader=ue4lib.MessageReader(outermsg.output())
reader._consume_bits(5)

ss=struct.unpack("<H", reader.read_bits_(14))[0] & 0x3fff
cs=struct.unpack("<H", reader.read_bits_(14))[0] & 0x3fff

print("client seq: ",end='')
print(cs)
print("server seq: ",end='')
print(ss)